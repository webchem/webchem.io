<!DOCTYPE html>
<html>

<head>
  <title>Web Chem</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
  <script type="text/javascript" src="JSmol.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script type="text/javascript">

    // simple2.htm: demonstration of using platform-aware Jmol with jQuery
    // author: Bob Hanson hansonr@stolaf.edu 8/11/2012 8:21:03 AM

    // ---------------------------------------------------------------------------------

    ////// special stuff just for this particular page

    ///// files //////

    var s = unescape(document.location.search);
    var script = 'set errorCallback "myCallback";'
      + 'set animationFPS 4;set antialiasdisplay;set measurementUnits angstroms;set zoomlarge false;'
      + 'set echo top left;echo loading XXXX...;refresh;'
      + 'load ":XXXX";set echo top center;echo XXXX;'
    var xxxx = s.split("_USE=")[0]
    if (xxxx.length < 2) {
      xxxx = "dihydrogen"
    } else {
      xxxx = xxxx.substring(1);
      if (xxxx.indexOf("load ") >= 0) {
        script = xxxx
        xxxx = ""
      }
    }
    if (xxxx)
      script = script.replace(/XXXX/g, xxxx)

    // --------------------------------------------------------------------------

    ////// every page will need one variable and one Info object for each applet object

    var Info = {
      width: 300,
      height: 300,
      script: script,
      use: "HTML5",
      jarPath: "java",
      j2sPath: "j2s",
      jarFile: "JmolAppletSigned.jar",
      isSigned: false,
      addSelectionOptions: false,
      serverURL: "https://chemapps.stolaf.edu/jmol/jsmol/php/jsmol.php",
      readyFunction: null,
      console: "jmol_infodiv",
      disableInitialConsole: true,
      defaultModel: null,
      debug: false
    }

    // this next bit just allows us to see what platform we are on
    // based on our decisions indicated in Info

    // "true" here indicates just a check

    Jmol.getApplet("appletCheck", Info, true);

    var isApplet = (appletCheck._jmolType.indexOf("_Applet") >= 0);
    console.log(isApplet);
    var is2D = appletCheck._is2D;

    if (!isApplet && !Info.script) {


      Info.defaultModel = "$tylenol";
      Info.script = "#alt:LOAD :tylenol";

    }


    $(document).ready(function () {

      $("#middlepanel").html(Jmol.getAppletHtml("jmol", Info));
      document.getElementById('jmol_canvas2d').style.width = '100%';
      document.getElementById('jmol_canvas2d').style.height = '100%';
      document.getElementById('middlepanel').setAttribute('class', 'text-center');
      console.log('Robapollos' + document.getElementById('jmol_canvas2d').style.height);
    })

    cont = 2;
    let files = [];
    for (let i = 0; i < 8; i++) {
      files.push("H0." + cont + ".pdb");
      cont++;
    }
    for (let i = 0; i < 10; i++) {
      files.push("H1." + i + ".pdb");
    }
    for (let i = 0; i < 10; i++) {
      files.push("H2." + i + ".pdb");
    }

    files.push("H3.0.pdb")
    console.log("Van los files: ", files)


    console.log(files.reverse())


    var jsmolPath = ''; /*ADJUST TO YOUR PATH*/
    var Info = {
      j2sPath: jsmolPath + "j2s",
      serverURL: jsmolPath + "php/jsmol.php", //THIS LINE IS ESSENTIAL FOR CROSS-SITE FILE LOADING
      src: 'PDB/H2/H2.9.pdb'
    };


    /////////////////// Grafico /////////////////

    function readTextFile(file, callback) {
      var rawFile = new XMLHttpRequest();
      rawFile.overrideMimeType("application/json");
      rawFile.open("GET", file, true);
      rawFile.onreadystatechange = function () {
        if (rawFile.readyState === 4 && rawFile.status == "200") {
          callback(rawFile.responseText);
        }
      }
      rawFile.send(null);
    }

    //usage:

    let data;

    let bla = readTextFile("base.json", function (text) {
      this.data = JSON.parse(text);
    });


    setTimeout(() => {

      cont = 2;
      let localFiles = [];
      for (let i = 0; i < 8; i++) {
        localFiles.push("H0." + cont + ".pdb");
        cont++;
      }
      for (let i = 0; i < 10; i++) {
        localFiles.push("H1." + i + ".pdb");
      }
      for (let i = 0; i < 10; i++) {
        localFiles.push("H2." + i + ".pdb");
      }

      localFiles.push("H3.0.pdb")
      console.log("Estos son los localfiles ", localFiles)
      localFiles = localFiles.reverse();

      console.log(this.data.distancia);
      console.log(this.localFiles)
      var myPlot = document.getElementById('myDiv'),
        x = this.data.distancia,
        y = this.data.energia,
        data = [{
          x: x,
          y: y,
          type: 'scatter',
          mode: 'markers',
          marker: { size: 10 },
          text: localFiles
        }],
        layout = {
          // hovermode: 'closest',
          title: 'Click on Points'
        };

      Plotly.newPlot('myDiv', data, layout);

      myPlot.on('plotly_click', function (data) {
        // this.Info.src = "PDB/H2/" + data.points[0].text

        var jsmolPath = ''; /*ADJUST TO YOUR PATH*/
        var Info = {
          j2sPath: jsmolPath + "j2s",
          serverURL: jsmolPath + "php/jsmol.php", //THIS LINE IS ESSENTIAL FOR CROSS-SITE FILE LOADING
          src: "PDB/H2/" + data.points[0].text
        };

        $("#middlepanel").html(Jmol.getAppletHtml("jmol", Info));

        console.log("PDB/H2/" + data.points[0].text)
      });

    }, 1000)


  </script>
</head>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">

  <a class="navbar-brand" href="#"><img src="Images/unal.PNG" width="auto" height="100" alt="">WebChem</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="#">Inicio <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Propiedades atómicas</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="#">Enlace</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Dipolos</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Rotaciones de enlace</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Reactividad orgánica</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#">Efecto inductivo</a>
      </li>
      <!-- <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          Dropdown
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
          <a class="dropdown-item" href="#">Action</a>
          <a class="dropdown-item" href="#">Another action</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="#">Something else here</a>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link disabled" href="#">Disabled</a>
      </li> -->
    </ul>

  </div>

</nav>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<div class="container">
  <div class="row">
    <div class="col-md-6 col-sm-12">
      <h1>Dihidrógeno</h1>
      <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Iste tenetur sit nisi iusto, impedit cum inventore
        beatae est pariatur, voluptatum quaerat dolores deserunt maxime dolor praesentium. Itaque non tenetur facilis?
      </p>
      <div class="row d-flex justify-content-center">

        <!--Grid column-->
        <div class="col-md-6 col-sm-6">

          <div id="middlepanel"></div>

        </div>
        <!--Grid column-->

      </div>
    </div>
    <div class="col-md-6 col-sm-12">
      <!-- <img src="Images/H2.png" width="100%" alt=""> -->
      <div id="myDiv" style="width: 700px; height: 500px;"></div>
    </div>
    <div>
      <p>
        <!-- <script>
          Jmol.getApplet('jsmolApplet0', Info);
        </script>
        <input type="button" value="load molecule" class="interactionButtonStructure">
      </p> -->
    </div>
  </div>


  </body>


</html>